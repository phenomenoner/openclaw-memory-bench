# Devlog — 2026-02-09

## Milestone 9: P0 hardening (schema validation + failure taxonomy)

Completed:
- Added `src/openclaw_memory_bench/validation.py` with:
  - `validate_dataset_payload`
  - `validate_retrieval_report_payload`
  - `SchemaValidationError`
- Wired validation into runtime path:
  - `cmd_prepare_dataset` now validates converted dataset before writing
  - `load_retrieval_dataset` validates JSON payload at load time
  - `run_retrieval_benchmark` validates final retrieval report before returning/saving
- Standardized runner failure shape with explicit fields:
  - `phase`
  - `error_code`
  - `error_category`
  - `retryable`
  - `exception_type`
  - `error`
- Added summary failure rollups:
  - `summary.failure_breakdown.by_code`
  - `summary.failure_breakdown.by_category`
  - `summary.failure_breakdown.by_phase`
- Added tests (`tests/test_runner_and_validation.py`):
  - success path includes failure breakdown
  - timeout path emits standardized failure metadata
  - dataset validation catches invalid relevant-session references
- Minor lint hardening: renamed ambiguous var in sidecar compare script (`l` → `latency`).

Validation:
- `uv run --python 3.13 --with pytest -- pytest -q` → 12 passed
- `uv run --python 3.13 --with ruff -- ruff check` → all checks passed

Notes:
- This remains within Phase A hardening scope; no Phase B work started.

## Milestone 10: memu extraction hardening + seeded sampling controls

Completed:
- Hardened `memu-engine` session-id extraction logic:
  - path parsing for `session-*.md/json/jsonl` (including `:line:col` suffixes)
  - snippet parsing for `[session:<id>]` markers
  - snippet parsing for `session_id: <id>` style hints
  - fallback file-token extraction from snippet text
- Added deterministic subset sampling controls in retrieval runner:
  - `--sample-size`
  - `--sample-seed` (default internal seed `0` when omitted)
  - semantics: sample first, then apply `--limit`
- Manifest/report propagation:
  - run manifest now stores `sample_size` + `sample_seed`
  - report config now stores `sample_size` + `sample_seed`
- Added tests:
  - `tests/test_memu_adapter.py` expanded session-id extraction coverage
  - `tests/test_runner_and_validation.py` now verifies seeded determinism and size guardrails
  - `tests/test_manifest.py` verifies sample parameters in manifest
